services:
  api-gateway:
    container_name: api-gateway
    image: doyts/watmarker-api-gateway
    build:
      context: .
      dockerfile: ./microservice/api_gateway/Dockerfile
    ports:
      - 8080:8080
    volumes:
      - ./microservice/api_gateway/.env:/.env
    depends_on:
      - watermark

  watermark:
    container_name: watermark-service
    image: doyts/watmarker-watermark
    build:
      context: .
      dockerfile: ./microservice/watermark_service/Dockerfile
    ports:
      - 6000:6000
    volumes:
      - ./microservice/watermark_service/.env:/.env

  web-app:
    container_name: web-app
    working_dir: /app
    image: doyts/watmarker-web-app
    build:
      context: ./microservice/web_app
      dockerfile: dev.Dockerfile
    ports:
      - 3000:5173
    volumes:
      - /app/node_modules
      - ./microservice/web_app/:/app
      - ./microservice/web_app/.env:/.env:rw
    depends_on:
      - api-gateway
